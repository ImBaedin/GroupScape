name: Tests

on:
  pull_request:
  push:
    branches:
      - main

jobs:
  typecheck:
    name: Typecheck
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: oven-sh/setup-bun@v2
      - name: Install dependencies
        run: bun install
      - name: Web typecheck
        run: bun run --filter web check-types
      - name: Backend typecheck
        run: bun run --filter @GroupScape/backend check-types
      - name: RuneLite client typecheck
        run: bun run --filter @GroupScape/runelite-party-client check-types
      - name: OSRS content typecheck
        run: bun run --filter @GroupScape/osrs-content check-types

  test-unit:
    name: Unit Tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: oven-sh/setup-bun@v2
      - name: Install dependencies
        run: bun install
      - name: Run unit tests
        run: bun run test:unit

  test-integration:
    name: Integration Tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: oven-sh/setup-bun@v2
      - name: Install dependencies
        run: bun install
      - name: Run integration tests
        run: bun run test:integration
